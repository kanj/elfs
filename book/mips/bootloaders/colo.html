<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content=
    "application/xhtml+xml; charset=iso-8859-1" />
    <title>
      11.4.&nbsp;Colo-1.22
    </title>
    <link rel="stylesheet" href="../stylesheets/lfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="clfs" id="clfs-GIT-0.0.1-20130730-mips">
    <div class="navheader">
      <h4>
        Embedded Linux from Source - Version GIT-0.0.1-20130730-mips
      </h4>
      <h3>
        Chapter&nbsp;11.&nbsp;Bootloaders
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="patches.html" title=
          "Needed Patches">Prev</a>
          <p>
            Needed Patches
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="../part5.html" title=
          "Cleanup and Boot">Next</a>
          <p>
            Cleanup and Boot
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter.html" title=
          "Chapter&nbsp;11.&nbsp;Bootloaders">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Embedded Linux from Source - Version GIT-0.0.1-20130730-mips">Home</a>
        </li>
      </ul>
    </div>
    <div class="wrap" lang="en" xml:lang="en">
      <h1 class="sect1">
        <a id="ch-bootloaders-colo" name="ch-bootloaders-colo"></a>11.4.
        Colo-1.22
      </h1>
      <div class="package" lang="en" xml:lang="en">
        <p>
          This bootloader is for the MIPS based cobalt servers RaQ, RaQ2,
          Qube, or the Qube2.
        </p>
      </div>
      <div class="installation" lang="en" xml:lang="en">
        <h2 class="sect2">
          11.4.1. Installation of Colo
        </h2>
        <p>
          This patch updates the Colo bootloader to build under
          cross-compiled conditions:
        </p>
        <pre class="userinput">
<kbd class="command">patch -Np1 -i ../colo-1.22-make_fix-1.patch</kbd>
</pre>
        <p>
          This patch fixes a relocation error when linking with Binutils:
        </p>
        <pre class="userinput">
<kbd class="command">patch -Np1 -i ../colo-1.22-relocation_fix-1.patch</kbd>
</pre>
        <p>
          Compile the Colo package:
        </p>
        <pre class="userinput">
<kbd class="command">make CROSS_COMPILE="${CLFS_TARGET}-" binary
make CROSS_COMPILE="${CLFS_TARGET}-" tooldirs</kbd>
</pre>
        <p>
          Install the package:
        </p>
        <pre class="userinput">
<kbd class=
"command">install -v tools/lcdtools/e2fsck-lcd/e2fsck-lcd ${CLFS}/sbin
install -v tools/lcdtools/e2fsck-lcd/e2fsck-lcd.8 ${CLFS}/usr/man/man8
install -v tools/lcdtools/paneld/paneld ${CLFS}/sbin
install -v tools/lcdtools/paneld/paneld.8 ${CLFS}/usr/man/man8
install -v tools/lcdtools/putlcd/putlcd ${CLFS}/sbin
install -v tools/lcdtools/putlcd/putlcd.8 ${CLFS}/usr/man/man8
cp -v chain/colo-chain.elf ${CLFS}/boot/vmlinux
gzip -9 ${CLFS}/boot/vmlinux</kbd>
</pre>
      </div>
      <div class="configuration" lang="en" xml:lang="en">
        <h2 class="sect2">
          11.4.2. Configuration of Colo
        </h2>
        <p>
          Your shiny new CLFS system is almost complete. One of the last
          things to do is ensure you can boot it. The instructions below
          apply only to Cobalt RaQ1/RaQ2/Cube2 servers. Information on
          &ldquo;<span class="quote">boot loading</span>&rdquo; for other
          architectures should be available in the usual resource-specific
          locations for those architectures.
        </p>
        <p>
          Boot loading can be a complex area, so a few cautionary words are
          in order. Be familiar with the current boot loader and any other
          operating systems present on the hard drive(s) that need to be
          bootable. Make sure that an emergency boot disk is ready to
          &ldquo;<span class="quote">rescue</span>&rdquo; the computer if the
          computer becomes unusable (un-bootable).
        </p>
        <p>
          Earlier, we compiled and installed the Cobalt boot loader software
          in preparation for this step. Now we will configure our system to
          boot using Colo. Here is a simple <code class=
          "filename">default.colo</code> to use.
        </p>
        <pre class="userinput">
<kbd class="command">cat &gt; /boot/default.colo &lt;&lt; EOF
<code class="literal">#:CoLo:#
#
# load linux
#
lcd 'Booting 2.6.38.2...'
load vmlinux-2.6.38.2.gz
execute root=/dev/hda2 console=ttyS0,115200 ide1=noprobe</code>
EOF</kbd>
</pre>
        <p>
          The FHS stipulates that the bootloader's configuration file should
          be symlinked to <code class="filename">/etc/{Bootloader
          Name}</code>. To satisfy this requirement for Colo, issue the
          following command:
        </p>
        <pre class="userinput">
<kbd class="command">mkdir -v ${CLFS}/etc/colo &amp;&amp;
ln -sv ../boot/colo/default.colo ${CLFS}/etc/colo</kbd>
</pre>
      </div>
      <div class="kernel" lang="en" xml:lang="en">
        <h2 class="sect2">
          11.4.3. Kernel Configuration for Colo
        </h2>
        <p>
          To help keep our system small Colo allows us to compress our
          kernel. The followings step will show you how to compress the
          kernel the way colo expects it:
        </p>
        <pre class="userinput">
<kbd class="command">gzip -9 ${CLFS}/boot/vmlinux-2.6.38.2</kbd>
</pre>
      </div>
      <div class="content" lang="en" xml:lang="en">
        <h2 class="sect2">
          <a id="contents-colo" name="contents-colo"></a>11.4.4. Contents of
          Colo
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Installed programs:</strong>
              <span class="segbody">colo-chain.elf, e2fsck-lcd, paneld and
              putlcd</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Short Descriptions
          </h3>
          <table border="0">
            <col align="left" valign="top" />
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="colo-chain.elf" name=
                    "colo-chain.elf"></a><span class="term"><span class=
                    "command"><strong>colo</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    Is the Cobalt Bootloader's chain mode executeable. This
                    file gets gzipped and renamed to <code class=
                    "filename">vmlinux.gz</code>, so it can be booted
                    automatically by the Cobalt's existing firmware
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="e2fsck-lcd" name="e2fsck-lcd"></a><span class=
                    "term"><span class=
                    "command"><strong>e2fsck-lcd</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    Will output file system check progress information on the
                    Cobalt LCD
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="paneld" name="paneld"></a><span class=
                    "term"><span class=
                    "command"><strong>paneld</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    Is an admin tool for the LCD panel of Cobalt machines. By
                    default, it will display the current time and optionally
                    a message. When you hold the enter or select button for a
                    couple of seconds you will get an admin menu. The menu
                    will allow you to either halt or reboot your Cobalt
                    machine
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="putlcd" name="putlcd"></a><span class=
                    "term"><span class=
                    "command"><strong>putlcd</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    Is a tool to display text on the LCD display of Cobalt
                    machines
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="patches.html" title=
          "Needed Patches">Prev</a>
          <p>
            Needed Patches
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="../part5.html" title=
          "Cleanup and Boot">Next</a>
          <p>
            Cleanup and Boot
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter.html" title=
          "Chapter&nbsp;11.&nbsp;Bootloaders">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Embedded Linux from Source - Version GIT-0.0.1-20130730-mips">Home</a>
        </li>
      </ul>
    </div>
  </body>
</html>
