<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content=
    "application/xhtml+xml; charset=iso-8859-1" />
    <title>
      4.2.&nbsp;Setting Up the Environment
    </title>
    <link rel="stylesheet" href="../stylesheets/lfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="clfs" id="clfs-GIT-0.0.1-20130717-arm">
    <div class="navheader">
      <h4>
        Embedded Linux from Source - Version GIT-0.0.1-20130717-arm
      </h4>
      <h3>
        Chapter&nbsp;4.&nbsp;Final Preparations
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="aboutlfs.html" title="About $CLFS">Prev</a>
          <p>
            About $CLFS
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="creatingdirs.html" title=
          "Creating Directories">Next</a>
          <p>
            Creating Directories
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter.html" title=
          "Chapter&nbsp;4.&nbsp;Final Preparations">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Embedded Linux from Source - Version GIT-0.0.1-20130717-arm">Home</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="en" xml:lang="en">
      <h1 class="sect1">
        <a id="ch-final-preps-settingenviron" name=
        "ch-final-preps-settingenviron"></a>4.2. Setting Up the Environment
      </h1>
      <pre class="userinput">
<kbd class="command">export ${CLFS}=/mnt/clfs</kbd>
</pre>
      <p>
        To ensure a clean separation between host and build environments we
        will create a custum .bashrc file. This file will be read when
        invoking a non-login instance of bash.
      </p>
      <p>
        The new instance of the shell is a <span class=
        "emphasis"><em>non-login</em></span> shell, which does not read the
        <code class="filename">/etc/profile</code> or <code class=
        "filename">.bash_profile</code> files, but rather reads the
        <code class="filename">.bashrc</code> file instead. Create the
        <code class="filename">.bashrc</code> file now:
      </p>
      <pre class="userinput">
<kbd class="command">cat &gt; ${CLFS}/.bashrc &lt;&lt; "EOF"
<code class="literal">set +h
umask 022
CLFS=/mnt/clfs
HOME=/mnt/clfs
PS1='clfs-\u:\w\$'
LC_ALL=POSIX
PATH=${CLFS}/cross-tools/bin:/bin:/usr/bin
export CLFS LC_ALL PATH</code>
EOF</kbd>
</pre>
      <p>
        The <span class="command"><strong>set +h</strong></span> command
        turns off <span class="command"><strong>bash</strong></span>'s hash
        function. Hashing is ordinarily a useful feature&mdash;<span class=
        "command"><strong>bash</strong></span> uses a hash table to remember
        the full path of executable files to avoid searching the <code class=
        "envar">PATH</code> time and again to find the same executable.
        However, the new tools should be used as soon as they are installed.
        By switching off the hash function, the shell will always search the
        <code class="envar">PATH</code> when a program is to be run. As such,
        the shell will find the newly compiled tools in <code class=
        "filename">${CLFS}/cross-tools</code> as soon as they are available
        without remembering a previous version of the same program in a
        different location.
      </p>
      <p>
        Setting the user file-creation mask (umask) to 022 ensures that newly
        created files and directories are only writable by their owner, but
        are readable and executable by anyone (assuming default modes are
        used by the open(2) system call, new files will end up with
        permission mode 644 and directories with mode 755).
      </p>
      <p>
        The <code class="envar">CLFS</code> variable should be set to the
        chosen mount point.
      </p>
      <p>
        The <code class="envar">LC_ALL</code> variable controls the
        localization of certain programs, making their messages follow the
        conventions of a specified country. If the host system uses a version
        of Glibc older than 2.2.4, having <code class="envar">LC_ALL</code>
        set to something other than &ldquo;<span class=
        "quote">POSIX</span>&rdquo; or &ldquo;<span class=
        "quote">C</span>&rdquo; (during this chapter) may cause issues if you
        exit the chroot environment and wish to return later. Setting
        <code class="envar">LC_ALL</code> to &ldquo;<span class=
        "quote">POSIX</span>&rdquo; or &ldquo;<span class=
        "quote">C</span>&rdquo; (the two are equivalent) ensures that
        everything will work as expected in the chroot environment.
      </p>
      <p>
        By putting <code class="filename">${CLFS}/cross-tools/bin</code> at
        the beginning of the <code class="envar">PATH</code>, the
        cross-compiler built in <a class="xref" href=
        "../cross-tools/chapter.html" title=
        "Chapter&nbsp;6.&nbsp;Constructing Cross-Compile Tools">Constructing
        Cross-Compile Tools</a> will be picked up by the build process for
        the temp-system packages before anything that may be installed on the
        host. This, combined with turning off hashing, helps to ensure that
        you will be using the cross-compile tools to build the temp-system in
        /tools.
      </p>
      <p>
        Finally, to have the environment fully prepared for building the
        temporary tools, source the just-created user profile:
      </p>
      <pre class="screen">
 
To access the special environment launch the bash shell as follows: export CLFS=/mnt/clfs; bash --rcfile ${CLFS}/.bashrc 
To use this environment in a shell script do as follows:    export CLFS=/mnt/clfs ; source ${CLFS}/.bashrc
</pre>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="aboutlfs.html" title="About $CLFS">Prev</a>
          <p>
            About $CLFS
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="creatingdirs.html" title=
          "Creating Directories">Next</a>
          <p>
            Creating Directories
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter.html" title=
          "Chapter&nbsp;4.&nbsp;Final Preparations">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Embedded Linux from Source - Version GIT-0.0.1-20130717-arm">Home</a>
        </li>
      </ul>
    </div>
  </body>
</html>
